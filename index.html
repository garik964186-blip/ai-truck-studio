<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Book: BOSS Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --bg-color: #0b0b0e; 
            --card-bg: #16161a; 
            --text-color: #e0e0e0;
            --accent-color: #ff0055; 
            --accent-grad: linear-gradient(135deg, #ff0055, #ff5500);
            --input-bg: #222226; 
            --border-radius: 15px;
        }

        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: var(--bg-color); 
            color: var(--text-color); 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            perspective: 2000px; /* –ì–ª—É–±–∏–Ω–∞ 3D */
            overflow: hidden;
        }
        
        /* –ö–û–ù–¢–ï–ô–ù–ï–† –ö–ù–ò–ì–ò */
        .book { 
            width: 95%; 
            max-width: 500px; 
            height: 90vh; 
            position: relative; 
            transition: transform 0.8s cubic-bezier(0.645, 0.045, 0.355, 1); 
            transform-style: preserve-3d; 
        }

        /* –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .book.flipped { 
            transform: rotateY(-180deg); 
        }

        /* –û–ë–©–ò–ï –°–¢–ò–õ–ò –°–¢–û–†–û–ù (–°–¢–†–ê–ù–ò–¶) */
        .page { 
            position: absolute; 
            width: 100%; 
            height: 100%; 
            backface-visibility: hidden; 
            border-radius: var(--border-radius); 
            background: var(--card-bg); 
            border: 2px solid #333; 
            display: flex; 
            flex-direction: column; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
        }
        
        /* –ó–ê–î–ù–Ø–Ø –°–¢–û–†–û–ù–ê (–ß–ê–¢) ‚Äî –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ */
        .page.back { 
            transform: rotateY(180deg); 
        }

        .content { 
            padding: 15px; 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
            overflow-y: auto; 
        }

        .header { 
            text-align: center; 
            border-bottom: 1px solid #333; 
            padding-bottom: 10px; 
            margin-bottom: 5px;
        }

        .banner-img { 
            width: 100%; 
            height: 90px; 
            border-radius: 8px; 
            object-fit: cover; 
            border: 1px solid var(--accent-color); 
        }

        /* –ö–ù–û–ü–ö–ò */
        .flip-btn { 
            background: var(--accent-grad); 
            color: white; 
            border: none; 
            padding: 12px; 
            border-radius: 10px; 
            font-weight: bold; 
            cursor: pointer; 
            transition: 0.3s;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 1px;
        }
        
        .flip-btn:active { transform: scale(0.95); }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –ì–ï–ù–ï–†–ê–¶–ò–ò */
        .controls { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 8px; 
        }

        select, textarea, input { 
            background: var(--input-bg); 
            border: 1px solid #444; 
            color: white; 
            padding: 12px; 
            border-radius: 10px; 
            width: 100%; 
            box-sizing: border-box; 
            font-size: 14px;
        }

        #image-container { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
            margin-top: 10px; 
        }

        .img-wrapper {
            position: relative;
            animation: fadeIn 0.5s ease;
        }

        .img-wrapper img { 
            width: 100%; 
            border-radius: 8px; 
            border: 1px solid #444; 
            display: block;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* –ò–ù–¢–ï–†–§–ï–ô–° –ß–ê–¢–ê */
        #chat-container { 
            flex: 1; 
            background: #000; 
            border-radius: 10px; 
            padding: 12px; 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
            border: 1px solid #222; 
        }

        .message { 
            padding: 10px 14px; 
            border-radius: 12px; 
            font-size: 14px; 
            max-width: 85%; 
            line-height: 1.4;
        }

        .message.user { 
            align-self: flex-end; 
            background: var(--accent-color); 
            color: white;
            border-bottom-right-radius: 2px;
        }

        .message.ai { 
            align-self: flex-start; 
            background: #2a2a2e; 
            border: 1px solid #3d3d42;
            border-bottom-left-radius: 2px;
        }

        .input-group {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }

    </style>
</head>
<body>

<div class="book" id="myBook">
    <div class="page front">
        <div class="content">
            <div class="header">
                <img src="1768422265866.jpg" class="banner-img" onerror="this.src='https://via.placeholder.com/500x100?text=–û–¢+–ò–ì–†–£–®–ö–ò+–î–û+–§–£–†–´'">
                <button class="flip-btn" onclick="toggleFlip()" style="margin-top: 10px; width: 100%;">üìñ –û—Ç–∫—Ä—ã—Ç—å –ß–∞—Ç ‚Üí</button>
            </div>
            
            <div class="controls">
                <select id="model-select">
                    <option value="flux">üöõ –ö–∞—á–µ—Å—Ç–≤–æ (Flux)</option>
                    <option value="flux-realism">üì∏ –†–µ–∞–ª–∏–∑–º (Real)</option>
                </select>
                <button class="flip-btn" style="background:#333" onclick="clearBoard()">üóëÔ∏è –°–±—Ä–æ—Å</button>
            </div>

            <textarea id="prompt-input" rows="3" placeholder="–û–ø–∏—à–∏ —á—Ç–æ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å... (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ö–∞–º–∞–∑ –ö5 –≤ —Ç—É–º–∞–Ω–µ)"></textarea>
            
            <button class="flip-btn" id="gen-btn" onclick="generateImage()" style="height: 55px; font-size: 16px;">üöÄ –ü–û–ï–•–ê–õ–ò</button>
            
            <div id="image-container"></div>
        </div>
    </div>

    <div class="page back">
        <div class="content">
            <div class="header">
                <button class="flip-btn" onclick="toggleFlip()" style="width: 100%;">‚Üê –ù–∞–∑–∞–¥ –∫ –ê—Ä—Ç–∞–º üìñ</button>
                <h3 style="margin: 10px 0 0 0; color: var(--accent-color);">üí¨ –ß–ê–¢ –° –ù–ï–ô–†–û–°–ï–¢–¨–Æ</h3>
            </div>

            <div id="chat-container"></div>

            <div class="input-group">
                <input type="text" id="chat-input" placeholder="–°–ø—Ä–æ—Å–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å..." onkeypress="if(event.key==='Enter') sendMessage()">
                <button class="flip-btn" onclick="sendMessage()" style="padding: 0 20px;">‚û§</button>
            </div>
            <button class="flip-btn" style="background:#333; font-size: 9px; padding: 5px;" onclick="clearChat()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
        </div>
    </div>
</div>

<script>
    // –ü–ï–†–ï–õ–ò–°–¢–´–í–ê–ù–ò–ï
    function toggleFlip() {
        document.getElementById('myBook').classList.toggle('flipped');
        stopSpeech();
    }

    // –ì–û–õ–û–°–û–í–û–ô –î–í–ò–ñ–û–ö
    function speak(text) {
        stopSpeech();
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ru-RU';
        u.rate = 1.1;
        window.speechSynthesis.speak(u);
    }

    function stopSpeech() { window.speechSynthesis.cancel(); }

    // –õ–û–ì–ò–ö–ê –ß–ê–¢–ê
    async function sendMessage() {
        const inp = document.getElementById('chat-input');
        const box = document.getElementById('chat-container');
        if(!inp.value.trim()) return;
        
        const m = inp.value;
        box.innerHTML += `<div class="message user">${m}</div>`;
        inp.value = '';
        
        const loader = document.createElement('div');
        loader.className = 'message ai';
        loader.innerText = '‚è≥ –î—É–º–∞—é...';
        box.appendChild(loader);
        box.scrollTop = box.scrollHeight;

        try {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å openai —á–µ—Ä–µ–∑ pollination
            const r = await fetch(`https://text.pollinations.ai/${encodeURIComponent(m)}?model=openai`);
            if (!r.ok) throw new Error("502");
            
            const t = await r.text();
            loader.innerHTML = marked.parse(t);
            speak(t.replace(/[#*`]/g, ''));
        } catch (err) {
            loader.innerHTML = `<span style="color: #ff5500">‚ö†Ô∏è –ë–æ—Å—Å, —Å–µ—Ä–≤–µ—Ä "–ø—Ä–∏–ª–µ–≥" (–û—à–∏–±–∫–∞ 502). –ü–æ–ø—Ä–æ–±—É–π —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É!</span>`;
        }
        box.scrollTop = box.scrollHeight;
    }

    function clearChat() {
        document.getElementById('chat-container').innerHTML = '';
        stopSpeech();
    }

    // –õ–û–ì–ò–ö–ê –ê–†–¢–û–í
    async function generateImage() {
        const pInput = document.getElementById('prompt-input');
        const btn = document.getElementById('gen-btn');
        const container = document.getElementById('image-container');
        
        if(!pInput.value.trim()) return;
        
        const originalText = btn.innerText;
        btn.innerText = "‚è≥ –†–ò–°–£–Æ...";
        btn.disabled = true;

        const p = pInput.value;
        const m = document.getElementById('model-select').value;
        const seed = Math.floor(Math.random() * 1000000);
        const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(p)}?model=${m}&seed=${seed}&nologo=true&width=1024&height=1024`;

        const wrap = document.createElement('div');
        wrap.className = 'img-wrapper';
        wrap.innerHTML = `
            <img src="${url}" onclick="window.open('${url}')" alt="AI Image">
            <a href="${url}" target="_blank" style="display:block; text-align:center; color:#777; font-size:10px; text-decoration:none; margin-top:3px;">üíæ –û—Ç–∫—Ä—ã—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª</a>
        `;
        
        container.prepend(wrap);
        
        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã
        setTimeout(() => {
            btn.innerText = originalText;
            btn.disabled = false;
        }, 1500);
    }

    function clearBoard() {
        document.getElementById('image-container').innerHTML = '';
        document.getElementById('prompt-input').value = '';
    }
</script>

</body>
</html>
