<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ULTRA ‚Äî –ú–ê–ì–ò–ß–ï–°–ö–ê–Ø –ö–ù–ò–ì–ê</title>
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg: #0b0b0e;
            --accent: #ff3b30;
            --text: #e0e0e0;
            --user-msg: #007aff;
            --ai-msg: #2c2c2e;
            --gold: #d4af37;
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            background: #050505; overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .viewport {
            width: 100vw; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            perspective: 2500px;
        }

        .book {
            width: 90vw; max-width: 400px; height: 80vh;
            position: relative; transform-style: preserve-3d;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }

        .page {
            position: absolute; width: 100%; height: 100%;
            top: 0; left: 0; transform-origin: left;
            transform-style: preserve-3d;
            transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .front, .back {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden;
            border-radius: 0 15px 15px 0;
            overflow: hidden;
        }

        /* –û–±–æ—Ä–æ—Ç–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≠—Ñ—Ñ–µ–∫—Ç –±—É–º–∞–≥–∏) */
        .back {
            transform: rotateY(180deg);
            background: linear-gradient(to right, #1a1a1a, #2a2a2a);
            border-radius: 15px 0 0 15px;
            display: flex; align-items: center; justify-content: center;
            border-left: 3px solid #000;
        }
        .back::after {
            content: "ULTRA"; color: rgba(255,255,255,0.05); font-size: 40px; font-weight: 900; transform: rotate(-45deg);
        }

        .flipped { transform: rotateY(-175deg); }

        /* –®–∞–ø–∫–∞ —Å —Ç–≤–æ–∏–º –±–∞–Ω–Ω–µ—Ä–æ–º */
        .page-header {
            height: 100px; position: relative; flex-shrink: 0; background: #000;
        }
        .banner {
            width: 100%; height: 100%; object-fit: cover; opacity: 0.6;
        }
        .header-label {
            position: absolute; bottom: 10px; width: 100%; text-align: center;
            font-weight: 900; font-size: 14px; color: #fff; text-transform: uppercase;
        }

        .app-content {
            background: var(--bg); color: var(--text);
            display: flex; flex-direction: column; height: 100%;
        }

        .selector-bar { padding: 8px; background: #16161a; display: flex; gap: 5px; border-bottom: 1px solid #333; }
        select { flex: 1; background: #222; color: #fff; border: 1px solid #444; padding: 8px; border-radius: 10px; font-size: 12px; outline: none; }

        .scroll-area { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .input-bar { padding: 12px; background: #16161a; display: flex; gap: 8px; align-items: center; border-top: 1px solid #333; }
        .field { flex: 1; background: #000; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 20px; outline: none; }

        .msg { padding: 10px 14px; border-radius: 15px; font-size: 14px; max-width: 85%; transition: 0.2s; }
        .msg.u { background: var(--user-msg); align-self: flex-end; }
        .msg.a { background: var(--ai-msg); align-self: flex-start; border: 1px solid #333; cursor: pointer; }
        .msg.a:active { transform: scale(0.95); opacity: 0.8; }

        .btn-mic { width: 44px; height: 44px; border-radius: 50%; border: none; background: #333; color: white; cursor: pointer; }
        .btn-mic.active { background: var(--accent); animation: pulse-mic 1.5s infinite; }
        @keyframes pulse-mic { 0% { box-shadow: 0 0 0 0 rgba(255, 59, 48, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(255, 59, 48, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 59, 48, 0); } }

        /* –û–±–ª–æ–∂–∫–∞ */
        .cover-page .front {
            background: linear-gradient(135deg, #3d0000 0%, #000 100%);
            border: 6px double var(--gold);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: var(--gold); text-align: center;
        }
    </style>
</head>
<body>

<div class="viewport">
    <div class="book">

        <div class="page" id="p3" style="z-index: 1;">
            <div class="front app-content">
                <div class="page-header">
                    <img src="1768422265866.jpg" class="banner" onerror="this.style.display='none'">
                    <div class="header-label">–ß–ê–¢ –ü–û–î–î–ï–†–ñ–ö–ò</div>
                </div>
                <div class="selector-bar">
                    <select id="m-chat">
                        <option value="openai">‚ö° GPT-4o</option>
                        <option value="gemini">‚ú® Gemini 1.5</option>
                    </select>
                </div>
                <div class="scroll-area" id="chat-box">
                    <div class="msg a" onclick="stopSpeak()">–ë–æ—Å—Å, —è –Ω–∞ —Å–≤—è–∑–∏. –¢–∫–Ω–∏ –≤ –º–µ–Ω—è, –µ—Å–ª–∏ —è –∑–∞–≥–æ–≤–æ—Ä—é—Å—å.</div>
                </div>
                <div class="input-bar">
                    <button id="mic-chat" class="btn-mic" onclick="startVoice('chat')"><i class="fas fa-microphone"></i></button>
                    <input type="text" id="i-chat" class="field" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter') sendMessage()">
                </div>
            </div>
            <div class="back"></div>
        </div>

        <div class="page" id="p2" style="z-index: 2;">
            <div class="front app-content">
                <div class="page-header">
                    <img src="1768422265866.jpg" class="banner" onerror="this.style.display='none'">
                    <div class="header-label">–ì–ï–ù–ï–†–ê–¶–ò–Ø –ê–†–¢–û–í</div>
                </div>
                <div class="selector-bar">
                    <select id="m-art">
                        <option value="flux">üöõ Flux Engine</option>
                        <option value="flux-realism">üì∏ Realism</option>
                    </select>
                </div>
                <div class="scroll-area" id="imgs-box">
                    <div style="text-align:center; color:#444; margin-top:50px;">
                        <i class="fas fa-camera-retro" style="font-size:40px;"></i><br><br>–û–ø–∏—à–∏ –∫–∞—Ä—Ç–∏–Ω–∫—É –≥–æ–ª–æ—Å–æ–º...
                    </div>
                </div>
                <div class="input-bar">
                    <button id="mic-art" class="btn-mic" onclick="startVoice('art')"><i class="fas fa-microphone"></i></button>
                    <input type="text" id="i-art" class="field" placeholder="–ñ–¥—É –ø—Ä–æ–º–ø—Ç..." readonly>
                </div>
            </div>
            <div class="back"></div>
        </div>

        <div class="page cover-page" id="p1" style="z-index: 3;">
            <div class="front" onclick="this.parentElement.classList.add('flipped')">
                <div style="border: 2px solid var(--gold); padding: 40px 20px; width: 80%;">
                    <i class="fas fa-truck-monster" style="font-size: 60px; margin-bottom: 20px;"></i>
                    <h1 style="font-size: 28px; letter-spacing: 3px; margin:0;">ULTRA</h1>
                    <p style="font-size: 14px; margin-bottom: 30px;">–û–¢ –ò–ì–†–£–®–ö–ò –î–û –§–£–†–´</p>
                    <div style="font-size: 10px; border-top: 1px solid var(--gold); padding-top: 20px;">–õ–ò–°–¢–ê–ô –î–õ–Ø –í–•–û–î–ê</div>
                </div>
            </div>
            <div class="back"></div>
        </div>

    </div>
</div>

<script>
    let startX = 0;
    let step = 1;

    // –°–≤–∞–π–ø—ã
    document.addEventListener('touchstart', e => startX = e.touches[0].clientX);
    document.addEventListener('touchend', e => {
        let diff = startX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 60) {
            if (diff > 0 && step < 3) { document.getElementById('p'+step).classList.add('flipped'); step++; }
            else if (diff < 0 && step > 1) { step--; document.getElementById('p'+step).classList.remove('flipped'); }
            stopSpeak();
        }
    });

    // –ì–æ–ª–æ—Å
    function startVoice(mode) {
        const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
        const rec = new Speech();
        rec.lang = 'ru-RU';
        const btn = document.getElementById('mic-'+mode);
        rec.onstart = () => btn.classList.add('active');
        rec.onend = () => btn.classList.remove('active');
        rec.onresult = (e) => {
            const t = e.results[0][0].transcript;
            if(mode==='art') { document.getElementById('i-art').value = t; genArt(t); }
            else { document.getElementById('i-chat').value = t; sendMessage(t); }
        };
        rec.start();
    }

    // –†–µ—á—å
    function speak(text) {
        stopSpeak();
        const msg = new SpeechSynthesisUtterance(text.replace(/[*#_`]/g, ''));
        msg.lang = 'ru-RU';
        window.speechSynthesis.speak(msg);
    }
    function stopSpeak() { window.speechSynthesis.cancel(); }

    // –ê—Ä—Ç
    async function genArt(prompt) {
        const box = document.getElementById('imgs-box');
        const model = document.getElementById('m-art').value;
        box.innerHTML = `<div class="msg a">–ü–µ—Ä–µ–≤–æ–∂—É –∏ —Ä–∏—Å—É—é: ${prompt}...</div>`;
        const tr = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=en&dt=t&q=${encodeURIComponent(prompt)}`);
        const trJ = await tr.json();
        const url = `https://image.pollinations.ai/prompt/${encodeURIComponent(trJ[0][0][0])}?model=${model}&nologo=true&seed=${Math.random()}`;
        const img = new Image();
        img.src = url;
        img.onload = () => box.innerHTML = `<img src="${url}" style="width:100%; border-radius:10px; border:1px solid #333;">`;
    }

    // –ß–∞—Ç
    async function sendMessage(t) {
        const box = document.getElementById('chat-box');
        const input = document.getElementById('i-chat');
        const val = t || input.value;
        if(!val) return;
        input.value = '';
        box.innerHTML += `<div class="msg u">${val}</div>`;
        const ai = document.createElement('div');
        ai.className = 'msg a';
        ai.onclick = stopSpeak;
        ai.innerText = "...";
        box.appendChild(ai);
        box.scrollTop = box.scrollHeight;
        
        const res = await fetch('https://text.pollinations.ai/', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({messages: [{role:'user', content: val}], model: document.getElementById('m-chat').value})
        });
        const data = await res.text();
        ai.innerHTML = marked.parse(data);
        speak(data);
        box.scrollTop = box.scrollHeight;
    }
</script>
</body>
</html>
